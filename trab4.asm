;;Angelo Monte Serrat Bonini------------------
;;Cronometro Circular---------------
#INCLUDE <P16F628A.INC>
__CONFIG _BODEN_ON & _CP_OFF & _PWRTE_ON & _WDT_OFF & _LVP_OFF &
_MCLRE_ON & _XT_OSC
CBLOCK
0x20
SEGUNDOS
LED
ENDC
;-----------------------------
ORG
0x0000
CLRF
PORTA ;;CONFIGURACAO DA PORTA A
MOVLW
D'7'
MOVWF
CMCON
GOTO
INICIO
;-----------------------------
ORG
0x0004
BCF
INTCON, T0IF
MOVLW
D'131'
MOVWF
TMR0
DECFSZ LED, 0
GOTO
END_T0
ZERO:
MOVLW
MOVWF D'125'
LED
DECF
GOTO
GOTO SEGUNDOS
UM
ZERO
MOVLW
B'11111110' ;PINOS DO NUMERO 0-------------------
MOVWF
PORTB
MOVLW
D'1'
MOVWF
SEGUNDOS
GOTO
END_T0
CALL BOTAO
;-------------------------------------------------------
UM:
DECF
SEGUNDOS
GOTO
DOIS ;; DIRECIONA PARA O PROXIMO NUMERO
MOVLW
B'00111000' ; PINOS DO NUMERO 1-------------
MOVWF
PORTB
MOVLW
D'2'
MOVWF
SEGUNDOS
GOTO
END_T0
;----------------------------------------------------
DOIS:
DECF
GOTO
SEGUNDOS
TRESMOVLW
B'11011101' ; PINOS DO NUMERO 2-----------
MOVWF
PORTB
MOVLW
D'3'
MOVWF
SEGUNDOS
GOTO
END_T0
;------------------------------------------------------
TRES:
DECF
SEGUNDOS
GOTO
QUATRO
MOVLW
B'01111101' ;PINOS DO NUMERO 3--------------
MOVWF
PORTB
MOVLW
D'4'
MOVWF
SEGUNDOS
GOTO
END_T0
;------------------------------------------------------
QUATRO:
DECF
SEGUNDOS
GOTO
CINCO
MOVLW
B'00111011' ;PINOS DO NUMERO 4---------------
MOVWF
PORTB
MOVLW
D'5'
MOVWF
SEGUNDOS
GOTO
END_T0
;----------------------------------------------------
CINCO:
DECF
SEGUNDOS
GOTO
SEIS
MOVLW
B'01110111' ;PINOS DO NUMERO 5 ---------------
MOVWF
PORTB
MOVLW
D'6'
MOVWF
SEGUNDOS
GOTO
END_T0
;--------------------------------------------
SEIS:
DECF
SEGUNDOS
GOTO
SETE
MOVLW
B'11110111' ; PINOS DO NUMERO 6--------------
MOVWF
PORTB
MOVLW
D'7'
MOVWF
SEGUNDOS
GOTO
END_T0
;---------------------------------------------
SETE:
DECF
SEGUNDOS
GOTO
OITO
MOVLW
B'00111100' ;PINOS DO NUMERO 7---------------
MOVWF
PORTB
MOVLW
D'8'
MOVWF
SEGUNDOS
GOTO
END_T0
;------------------------------------------
OITO:DECF
GOTO
MOVLW
MOVWF
MOVLW
MOVWF
GOTO
SEGUNDOS
NOVE
B'11111111' ; PINOS DO NUMERO 8-------------
PORTB
D'9'
SEGUNDOS
END_T0
;---------------------------------------------
NOVE:
MOVLW
B'00111111' ; PINOS DO NUMERO 9------------
MOVWF
PORTB
MOVWF
SEGUNDOS
GOTO
ZERO
CALL BOTAO
END_T0: RETURN
;-----------------------------
;------------------------------------------------
BOTAO:
L1:
BTFSS PORTA,1
;BOTÃO PRESSIONADO
GOTO L1
L2:
BTFSC PORTA,1
;BOTÃO SOLTO
GOTO L2
L3:
BTFSS PORTA,1
;PRESSIONADO NOVAMENTE
GOTO L3
RETURN
;-------------------------------------------------------
INICIO:
MOVLW
D'0'
MOVWF
SEGUNDOS
BANKSEL PORTA
CLRF
MOVLW
MOVWF PORTA
D'7'
CMCON
BANKSEL
MOVLW
MOVWF
MOVLW TRISA ;;DEFININDO OS PINOS DIGITAIS
B'11111111'
TRISA
B'00000000'
BANKSEL TRISB ;;DEFININDO OS PINOS
CLRF
TRISB
BANKSEL OPTION_REG ;; REGISTRADORES
MOVLW
B'10000101'
MOVWF
OPTION_REG
BANKSEL INTCON
MOVLW
B'10100000'
MOVWF
INTCON
BANKSEL TMR0MOVLW
MOVWF D'131'
TMR0
MOVLW
MOVWF D'125'
LED
END